<!--pages/ordercenter/ordercenter.wxml-->
<view class="order-center">
  <view class="tabs">
    <block wx:for="{{tabs}}" wx:key="index">
      <view class="tab {{activeTab==index?'active':''}}" data-index="{{index}}" bindtap="onTabChange">
        {{item.name}}
      </view>
    </block>
  </view>

  <block wx:if="{{orderList.length === 0}}">
    <view style="text-align:center;color:#888;margin:60rpx 0 40rpx 0;font-size:32rpx;">您没有相关订单</view>
  </block>
  <block wx:for="{{orderList}}" wx:key="orderId">
    <view class="order-card" >
      <view class="order-header">
        订单号：{{item.orderId}}
        <text class="status">{{item.statusText}}</text>
      </view>
      <block wx:for="{{item.products}}" wx:key="product_id">
        <view class="product-row" data-id="{{item.product_id}}" bindtap="goToProductInfo">
          <image src="http://localhost:8081{{item.product_img}}" class="product-img"/>
          <view class="product-info">
            <view class="product-title">{{item.product_name}}</view>
            <view class="product-desc">{{item.product_describe}}</view>
            <view class="product-price">￥{{item.product_price}} x {{item.count}}</view>
          </view>
        </view>
      </block>
      <view class="order-footer">
        <view class="order-footer-row">
          实付款：<text class="total">￥{{item.order_money}}</text>
        </view>
        <view class="order-footer-btns">
          <block wx:if="{{item.order_status==0}}">
            <button data-orderid="{{item.orderId}}" bindtap="cancelOrder">取消订单</button>
            <button data-orderid="{{item.orderId}}" bindtap="payOrder" type="primary">去付款</button>
          </block>
          <block wx:if="{{item.order_status==1}}">
            <button data-orderid="{{item.orderId}}" bindtap="refundOrder">申请退款</button>
          </block>
          <block wx:if="{{item.order_status==2}}">
            <button data-orderid="{{item.orderId}}" bindtap="refundOrder">申请退款</button>
          </block>
          <block wx:if="{{item.order_status==3}}">
            <button data-orderid="{{item.orderId}}" bindtap="confirmReceive">确认收货</button>
          </block>
        </view>
      </view>
    </view>
  </block>
</view>