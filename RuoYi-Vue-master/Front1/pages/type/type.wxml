<view class="home-container">
  <!-- 顶部搜索框，背景色与导航栏一致，包含搜索图标和输入框（可输入，点击或回车跳转搜索页） -->
  <view class="search-bar">
    <icon  type="search"  color="#aaa" class="search-icon" />
    <input class="search-input" placeholder="搜索商品" bindinput="onInput" value="{{searchName}}" confirm-type="search" bindconfirm="onSearch" />
    <button class="search-btn" bindtap="onSearch">搜索</button>
  </view>
  <view class="main">
    <scroll-view class="category-list" scroll-y enable-flex>
      <view class="category-item {{currentCategory === -1 ? 'active' : ''}}" bindtap="onCategoryTap" data-index="-1">
        全部类别
      </view>
      <block wx:for="{{categories}}" key="index" >
        <view class="category-item {{currentCategory === index ? 'active' : ''}}" bindtap="onCategoryTap" data-index="{{index}}">
          {{item.typeName}}
        </view>
      </block>
    </scroll-view>
    <view class="goods-section">
      <view class="tabs">
        <view class="tab {{currentTab === 0 ? 'active' : ''}}" bindtap="onTabTap" data-index="0">热门</view>
        <view class="tab {{currentTab === 1 ? 'active' : ''}}" bindtap="onTabTap" data-index="1">价格降序</view>
        <view class="tab {{currentTab === 2 ? 'active' : ''}}" bindtap="onTabTap" data-index="2">价格升序</view>
      </view>

      <scroll-view 
        class="goods-list" 
        scroll-y 
        enable-flex
        bindscrolltolower="onReachBottom"
        refresher-enabled="{{true}}"
        bindrefresherrefresh="onPullDownRefresh"
        refresher-triggered="{{isRefreshing}}"
      >
        <block wx:for="{{goodsList}}" wx:key="productId">
          <view class="goods-item" bindtap="onGoodsTap" data-id="{{item.productId}}">
            <image class="goods-img" src="http://localhost:8081{{item.productImg}}" mode="aspectFill" />
            <view class="goods-info">
              <view class="goods-title">{{item.productName}}</view>
              <view class="goods-desc">{{item.productDescribe}}</view>
              <view class="goods-detail">
                <text class="brand">{{item.productBrand}}</text>
                <text class="size">{{item.productSize}}</text>
                <text class="package">{{item.productPackage}}</text>
              </view>
              <view class="goods-price">
                <text class="price">￥{{item.productPrice}}</text>
                <text class="sign" wx:if="{{item.productSign}}">{{item.productSign}}</text>
              </view>
            </view>
            <view class="cart-btn" catchtap="onAddToCart" data-id="{{item.productId}}">
              <icon type="cart" size="20" class="cart-icon" />
            </view>
          </view>
        </block>
        <!-- 加载更多提示 -->
        <view class="loading-more" wx:if="{{loading}}">
          <text>加载中...</text>
        </view>
        <view class="no-more" wx:if="{{!hasMore && goodsList.length > 0}}">
          <text>没有更多了</text>
        </view>
      </scroll-view>
 
      
    </view>
  </view>
</view>